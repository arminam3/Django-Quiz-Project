{% extends "_base.html" %}
{% load static %}
{% load my_tags %}

	
	{% block title %}
	<!-- PAGE TITLE HERE -->
	<title>Quiz Detail</title>
	{% endblock title %}
	

	{% block head %}
	<!-- FAVICONS ICON -->
	<link rel="shortcut icon" type="image/png" href="{% static 'images/favicon.png' %}" />
    <!-- Form step -->
    <link href="{% static './vendor/jquery-smartwizard/dist/css/smart_wizard.min.css' %}" rel="stylesheet">
    <!-- Custom Stylesheet -->
	<link href="{% static './vendor/jquery-nice-select/css/nice-select.css' %}" rel="stylesheet">
    <link href="{% static './css/style.css' %}" rel="stylesheet">
    <link href="{% static './css/custumize.css' %}" rel="stylesheet">

	{% endblock head %}


    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper">
                    
	{% block page_header_name %}
		نتیجه آزمون
	{% endblock page_header_name %}
    {% block content %}
        <!--**********************************
            Content body start
        ***********************************-->
        <div class="content-body farsi">
            <div class="container-fluid " dir="rtl">
				{% include "message.html" %}
				<div class="row page-titles">
				<ol class="breadcrumb" dir="rtl" style="text-align: right;">
                        <li class="breadcrumb-item active"><a href="">نتایج آزمون ها </a></li>
                        <li class=""><a href="">
                            <span class="text-primary">&nbsp; / </span>
                            ترم {{quiz_his.quiz.lesson.term|e2fnum}}
                        </a></li>
                        <!-- <li class="breadcrumb-item"><a href=""></a></li> -->
                        <li class="breadcrumb-item"><a href="">
							<span class="text-primary">&nbsp; / </span>
							{{quiz_his.quiz.name}}</a></li>
                    </ol>
                </div>
               

				<!-- *****************************
					radi button start
				***************************** -->
				<!-- <form class="farsi"> -->
					<div class="row">
						<p name="problem_qustion_id" id="problem_qustion_id"  hidden>dddd</p>
						{% for quiz_history in quiz_histories %}		
							<div class="col-xl-6 col-lg-6">
									<div class="card" dir="">
										<div class="card-header 
										{% if quiz_history.user_answer == '5' %}
											bg-light text-dark
                                        {% elif quiz_history.question.answer != quiz_history.user_answer %}
                                            bg-primary-cus
                                        {% else %}
                                            bg-success-cus
                                        {% endif %}
                                        " >
											<span class="card-title
                                             {% if quiz_history.question.answer != quiz_history.user_answer %}
                                                text-white
                                             {% endif %} 
                                             col-12" dir="rtl">
                                                {% if quiz_history.question.explanation.strip %}
                                                    <span type="button" class="badge  badge-secondary" title="توضیحات"
                                                        data-bs-placement="left" data-bs-content="{{quiz_history.question.explanation}}" data-bs-toggle="popover">
                                                    {{forloop.counter|e2fnum}} 
                                                    </span> 
                                                {% else %}
                                                    <span class="badge  badge-primary">
                                                    {{forloop.counter|e2fnum}}
                                                    </span> 
                                                {% endif %}
												
												{{quiz_history.question.text}}</span>
												<div class="dropdown ms-auto text-center">
													<div class="btn-link" data-bs-toggle="dropdown" style="transform: rotate(90deg);margin: -1em;">
														<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"></rect><circle fill="#000000" cx="5" cy="12" r="2"></circle><circle fill="#000000" cx="12" cy="12" r="2"></circle><circle fill="#000000" cx="19" cy="12" r="2"></circle></g></svg>
													</div>
													<div class="dropdown-menu dropdown-menu-start">
														<a onclick="changeReportProblemButtonValue('{{quiz_history.question.id}}')"
															class="dropdown-item text-end" id="problemBottun"
															data-bs-toggle="modal" data-bs-target="#exampleModalCenter">
															گزارش مشکل سوال
														</a>
													</div>
												</div>
											<div class="basic-form col-3">
											</div>
										</div>
										<div class="card-body">
											<div class="basic-form">
												<div class="row">
														{% if quiz_history.question.image %}
														<div id="" class="" style="text-align: center;"> 
															<a href="{{quiz_history.question.image.url}}" data-exthumbimage="images/big/img1.jpg" data-src="images/big/img1.jpg" class="col-lg-3 col-md-6 mb-4">
																<img class="image-container-zoom-cus" src="{{quiz_history.question.image.url}}" alt="" style="max-height: 10em;margin-right:1.5em;border-radius: 1em;display: block; margin: 0 auto;"/>
																<p style="font-size: 0.7em;margin-right:2.5em;white-space: nowrap;">با کلیک بر تصویر بزرگنمایی کنید.</p>
															</a>
														</div>
														{% endif %}
														<div class="col-xl-4 col-xxl-12 col-12">
															<div class="form-check  form-check-cus custom-checkbox mb-0 checkbox-info " style="font-size: small;">
																<!-- <div class="row"> -->
																	<!-- <input  type="text" value="" class="form-check-input form-check-input-cus" id="customRadioBox3" name="optradioCustom"> -->
																	<span class="form-check-input   left-forced-cus" > ۱ ) </span>
                                                                    <label class="form-check-label form-check-label-cus  
                                                                    {% if quiz_history.question.answer == '1' %}
                                                                    btn-success-rounded-cus
                                                                    {% endif %}
                                                                    {% if quiz_history.user_answer == '1' %}
                                                                    {% if quiz_history.question.answer != '1' %}
                                                                      
                                                                    btn-danger-rounded-cus
                                                                    {% endif %}
                                                                    {% endif %}
                                                                    " for="customRadioBox3"  style="text-align: justifyp;">{{quiz_history.question.choice_1}}</label>
                                                                    <!-- </div> -->
															</div>
														</div>
														<div class="col-xl-4 col-xxl-12 col-12">
															<div class="form-check  form-check-cus custom-checkbox mb-0 checkbox-info ">
																<!-- <input  type="radio" class="form-check-input form-check-input-cus" id="customRadioBox3" name="optradioCustom"> -->
																<span class="form-check-input   left-forced-cus" > ۲ ) </span>
																<label class="form-check-label form-check-label-cus  
                                                                {% if quiz_history.question.answer == '2' %}
                                                                btn-success-rounded-cus
                                                                {% endif %}
                                                                {% if quiz_history.user_answer == '2' %}
                                                                {% if quiz_history.question.answer != '2' %}
                                                                  
                                                                btn-danger-rounded-cus
                                                                {% endif %}
                                                                {% endif %}
                                                                " for="customRadioBox3" >{{quiz_history.question.choice_2}}</label>
															</div>
														</div>
														<div class="col-xl-4 col-xxl-12 col-12">
															<div class="form-check  form-check-cus custom-checkbox mb-0 checkbox-info ">
																<!-- <input  type="radio" class="form-check-input form-check-input-cus" id="customRadioBox3" name="optradioCustom"> -->
																<span class="form-check-input   left-forced-cus" > ۳ ) </span>
                                                                <label class="form-check-label form-check-label-cus  
                                                                {% if quiz_history.question.answer == '3' %}
                                                                btn-success-rounded-cus
                                                                {% endif %}
                                                                {% if quiz_history.user_answer == '3' %}
                                                                {% if quiz_history.question.answer != '3' %}
                                                                  
                                                                btn-danger-rounded-cus
                                                                {% endif %}
                                                                {% endif %}
                                                                " for="customRadioBox3" >{{quiz_history.question.choice_3}} </label>
                                                            </div>
														</div>
														<div class="col-xl-4 col-xxl-12 col-12">
															<div class="form-check  form-check-cus custom-checkbox mb-0 checkbox-info ">
																<!-- <input  type="radio" class="form-check-input form-check-input-cus" id="customRadioBox3" name="optradioCustom"> -->
																<span class="form-check-input   left-forced-cus" > ۴ ) </span>
                                                                <label class="form-check-label form-check-label-cus  
                                                                {% if quiz_history.question.answer == '4' %}
                                                                btn-success-rounded-cus
                                                                {% endif %}
                                                                {% if quiz_history.user_answer == '4' %}
                                                                {% if quiz_history.question.answer != '4' %}
                                                                  
                                                                btn-danger-rounded-cus
                                                                {% endif %}
                                                                {% endif %}
                                                                " for="customRadioBox3" >{{quiz_history.question.choice_4}}</label>
                                                            </div>
														</div>
													</div>
											</div>
											<!-- </form> -->
										</div>
									</div>
							</div>
						{% endfor %}
						<div>
						<div class="col-xl-2 col-lg-4">
							<div class="card" dir="rtl">
							<!-- Modal start -->
							<form action="{% url 'question_report' %}" method="POST">
								{% csrf_token %}
								<div class="modal fade farsi" id="exampleModalCenter">
										<div class="modal-dialog modal-dialog-centered" role="document">
											<div class="modal-content" >
												<div class="modal-header" dir="rtl">
													<h5 class="modal-title"> در صورت تمایل مشکل سوال را ذکر کنید .</h5>
													<button type="button" class="btn-close" data-bs-dismiss="modal" dir="ltr" style="position: absolute;left: 1em;">
													</button>
												</div>
												<div class="modal-body">
													<div class="form-group">
														<label for="message-text" class="col-form-label">شرح مشکل سوال :</label>
														<textarea class="form-control" id="message-text" name="report_content"></textarea>
													</div>
												</div>
											<input type="hidden" name="quiz_id" value="{{ quiz_his.quiz.id }}">
											<div class="modal-footer farsi">
												<button type="button" class="btn btn-dark light" data-bs-dismiss="modal">لغو</button>
												<button type="submit" class="btn btn-primary" name="reported_question_id" id="reportProblemButton"> ارسال </button>
											</div>
										</div>
									</div>
								</div>																						
							</form>
									<!-- modal end -->
							</div>																																																																																				
						</div></div>
					</div>
					<div class="row">
						<div class="col-xl-4 col-lg-4"></div>
						<div class="col-xl-4 col-lg-4">
							<div class="card " dir="rtl">
								<a href="{% url 'term_quiz_list' %}" type="submit" class="btn btn-primary" >بانک سوالات</a>
							</div>
						</div>	
						<div class="col-xl-4 col-lg-4"></div>
					</div>
				</div>
			</div>
		</div>
        <!--**********************************
            Content body end
			***********************************-->
    {% endblock content %}

    <!--**********************************
        Main wrapper end
    ***********************************-->

	
    
    <!--**********************************
        Scripts
        ***********************************-->
	{% block required_js %}
	<!-- {{ block.super }} -->
        <!-- Required vendors -->
	<script src="{% static './vendor/global/global.min.js' %}"></script>
    <script src="{% static './vendor/chart.js/Chart.bundle.min.js' %}"></script>
	<script src="{% static './vendor/apexchart/apexchart.js' %}"></script>


		<!--  -->
	<script src="{% static './vendor/jquery-steps/build/jquery.steps.min.js' %}"></script>
    <script src="{% static './vendor/jquery-validation/jquery.validate.min.js' %}"></script>
    <!-- Form validate init -->
    <script src="{% static './js/plugins-init/jquery.validate-init.js' %}"></script>


	<!-- Form Steps -->
	<script src="{% static './vendor/jquery-smartwizard/dist/js/jquery.smartWizard.js' %}"></script>
	<script src="{% static 'vendor/jquery-nice-select/js/jquery.nice-select.min.js' %}"></script>
	
	<script src="{% static './js/custom.js' %}"></script>
	<script src="{% static './js/dlabnav-init.js' %}"></script>
	<script src="{% static './js/demo.js' %}"></script>
    <script src="{% static './js/styleSwitcher.js' %}"></script>
	<script>
        $(document).ready(function(){
            // SmartWizard initialize
			$('#smartwizard').smartWizard(); 
		});
	</script>
	<script>
		const externalButton = document.getElementById('problemBottun');
		const modalButton = document.getElementById('reportProblemButton');

		// Add an event listener to the external button
		const changeReportProblemButtonValue = function(question_id) {
			// Change the value of the modal button
			modalButton.setAttribute('value', question_id);
		}

	</script>
    <script>
        function reportQuestionProblem(question_id){
            fetch(`{% url 'change_user_level' %}?user_id=${user_id}&action=${action}`, {
                method: 'GET'
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    window.location.href ='{% url "user_list" %}'
                } 
                if (data.success) {
                    window.location.href ='{% url "user_list" %}'
                } 
            })
            .catch(error => {
                // Handle errors here
            });
    }
    </script>
    {% endblock required_js %}


</html>